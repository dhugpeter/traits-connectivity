---
title: "Diversity and Connection"
author: "DHP"
date: "January 11, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r cars}
library(lattice)
dflmer <- readRDS("dflmer_w.rds")
str(dflmer)
plot(dflmer$RarRichness ~ log(dflmer$Overflow))
hist(dflmer$RarRichness)
plot(dflmer$FRic ~ log(dflmer$Overflow))
hist(dflmer$FRic)

e <- ggplot(dflmer, aes(log(Overflow+1),GastRichness))
e + geom_point()

e <- ggplot(dflmer, aes(F1,GastRichness))
e+geom_point()

tab_long_orders <- gather(dflmer, key = order, value = richness, 5:10)

f <- ggplot(tab_long_orders, aes(log(Overflow), richness))
f + geom_point() + facet_wrap(vars(order)) 

```



```{r pressure, echo=FALSE}
library(lme4)

names(dflmer)
m1 <- lm(GastRichness ~ I(Overflow^2)+season, data=dflmer)



dflmer$fstat <- factor(paste(dflmer$station, dflmer$site))
mm1 <-  lmer(GastRichness ~ Overflow + season + (1|station), data=dflmer)
summary(mm1)

mm2 <-  lmer(RarRichness~ F1+season+ 1|fstat,data=dflmer)
summary(mm2)


plot(mm1)
anova(mm1)
plot(mm2)



library(lattice)
plot(dflmer$RarRichness~factor(cut(dflmer$Overflow,3)))
plot(dflmer$RarRichness~factor(cut(dflmer$F1,3)))
plot(dflmer$FRic~factor(cut(dflmer$F1,3)))
plot(dflmer$FRic~factor(cut(dflmer$Overflow,3)))
dotplot(dflmer$FRic~log(dflmer$Overflow+1)|factor(dflmer$year))

factor(dflmer$Overflow)

library(MASS)
al <- lda(cut(dflmer$F1,3)~dflmer$RarRichness)
x11()
plot(al)
```

